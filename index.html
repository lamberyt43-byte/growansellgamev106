<!DOCTYPE html>
<html>

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>üåæ –í—ã—Ä–∞—Å—Ç–∏ –∏ –ø—Ä–æ–¥–∞–π!</title>

  <style>
    /* –§–æ–Ω –∏–≥—Ä—ã (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ä–∞–∑–º—ã—Ç—ã–π) */
#game-container {
    filter: blur(8px);
    transition: filter 0.5s ease;
}

/* –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω */
#start-screen {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 1000;
}

.logo-container {
    text-align: center;
    color: white;
}

.logo {
    max-width: 400px;
}

.press-text {
    font-size: 24px;
    margin-top: 20px;
    animation: blink 3s infinite;
}

/* –ú–∏–≥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ */
@keyframes blink {
    0%, 50%, 100% { opacity: 1; }
    25%, 75% { opacity: 0.3; }
}

body {
  font-family: 'Segoe UI', sans-serif;
  background: #f3f0e5;
  color: #333;
  text-align: center;
  padding: 20px;
}


#ramadanShop {
  background: linear-gradient(135deg,#0f3d2e,#1b5e20);
  border: 2px solid gold;
  padding: 20px;
  border-radius: 15px;
  margin-top: 15px;
  color: white;
}
.ramadan-pack {
  background: linear-gradient(135deg,#1b5e20,#b8860b);
  padding: 15px;
  margin: 10px 0;
  border-radius: 12px;
  border: 2px solid gold;
  box-shadow: 0 0 20px rgba(255,215,0,0.5);
}

#ramadanShop {
  background: linear-gradient(135deg,#0f3d2e,#3e2723);
  border: 2px solid gold;
  padding: 20px;
  border-radius: 20px;
  animation: glowRamadan 2s infinite alternate;
}

@keyframes glowRamadan {
  from { box-shadow: 0 0 20px gold; }
  to { box-shadow: 0 0 40px #00ff88; }
}

/* RAMADAN BANNER */
.ramadan-banner {
  margin: 15px auto;
  padding: 15px;
  border-radius: 15px;
  text-align: center;
  font-weight: bold;
  transition: 0.3s;
}

.ramadan-banner button {
  margin-top: 8px;
  background: gold;
  color: black;
}

.ramadan-sub {
  display: block;
  font-size: 13px;
  margin-top: 5px;
  opacity: 0.9;
}

/* –ë–æ–ª–æ—Ç–Ω—ã–π —Å—Ç–∏–ª—å */
.ramadan-banner.swamp {
  background: linear-gradient(135deg, #0f3d2e, #1b5e20);
  border: 2px solid #2e7d32;
  box-shadow: 0 0 20px rgba(0,100,0,0.6);
  color: #d4ffdf;
}

/* –ó–æ–ª–æ—Ç–æ–π —Å—Ç–∏–ª—å */
.ramadan-banner.gold {
  background: linear-gradient(135deg, #b8860b, #ffd700);
  border: 2px solid #fff176;
  box-shadow: 0 0 25px gold;
  color: #000;
}

#leaderboardTabs {
  display: flex;
  gap: 5px;
  margin-bottom: 8px;
}

#leaderboardTabs button {
  flex: 1;
  padding: 4px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}

.disco {
  animation: discoBg 0.4s infinite alternate;
}

@keyframes discoBg {
  0% { background-color: #ff0080; }
  25% { background-color: #00ffff; }
  50% { background-color: #ffff00; }
  75% { background-color: #00ff00; }
  100% { background-color: #ff0000; }
}

.glitch {
  animation: glitchAnim 0.1s infinite;
}

@keyframes glitchAnim {
  0% { transform: translate(2px, -2px); }
  50% { transform: translate(-2px, 2px); }
  100% { transform: translate(0, 0); }
}

.gray-screen-overlay {
  position: fixed;
  inset: 0;
  background: #888;
  z-index: 99998;
  pointer-events: none;
  animation: snapGrayFade 1s forwards;
}

@keyframes snapGrayFade {
  from { opacity: 0; }
  to { opacity: 1; }
}


.birthday-bg {
  animation: birthdayPulse 3s infinite alternate;
}

@keyframes birthdayPulse {
  0% { background-color: #ff99cc; }
  100% { background-color: #ff66aa; }
}




.birthday-text {
  position: fixed;
  top: 0;
  left: 0;
  font-size: 28px;
  font-weight: bold;
  color: white;
  text-shadow: 0 0 10px pink, 0 0 20px red;
  writing-mode: vertical-rl;   /* –í–ï–†–¢–ò–ö–ê–õ–¨–ù–´–ô –¢–ï–ö–°–¢ */
  text-orientation: mixed;
  animation: fallBirthday 5s linear forwards;
  pointer-events: none;
  z-index: 9999;
}
@keyframes fallBirthday {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(100vh);
  }
}


.left-text { left: 10px; }
.right-text { right: 1px; }

.ramadan-bg {
  animation: ramadanGlow 6s infinite alternate;
}

@keyframes ramadanGlow {
  0% { background-color: #1e2f1e; }
  100% { background-color: #2e4f2e; }
}

.ramadan-light {
  position: fixed;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #7CFC00;
  box-shadow: 0 0 10px #7CFC00;
  animation: fadeLight 2s ease-out forwards;
}

@keyframes fadeLight {
  0% { opacity: 0; transform: scale(0.5); }
  50% { opacity: 1; }
  100% { opacity: 0; transform: scale(1.5); }
}

#activeEventsBar {
  position: fixed;
  top: 60px; /* –Ω–∏–∂–µ —à–∞–∫–∏–ª–µ–π */
  right: 10px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  z-index: 9999;
}

.eventIcon {
  width: 42px;
  height: 42px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  cursor: pointer;
  position: relative;
  transition: transform 0.2s;
  
}

.eventIcon:hover {
  transform: scale(1.1);
}

.eventTooltip {
  position: absolute;
  right: 50px;
  background: rgba(0,0,0,0.8);
  color: white;
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 12px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: 0.2s;
}

.eventIcon:hover .eventTooltip {
  opacity: 1;
}

/* DISCO RGB */
.discoIcon {
  animation: rgb 2s infinite linear;
}

@keyframes rgb {
  0% { background: red; }
  25% { background: yellow; }
  50% { background: lime; }
  75% { background: cyan; }
  100% { background: red; }
}

/* LUCK */
.luckIcon {
  background: #2ecc71;
}

/* RAIN */
.rainIcon {
  background: #e74c3c;
}

.announcement {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(-10px);
  background: rgba(255, 255, 255, 0.75);
  backdrop-filter: blur(6px);
  color: #000;
  padding: 12px 18px;
  border-radius: 999px; /* –ø–ª–æ—Å–∫–∞—è —Ç–∞–±–ª–µ—Ç–∫–∞ */
  font-family: inherit;
  z-index: 99999;
  display: flex;
  align-items: center;
  gap: 10px;
  animation: annIn 0.25s ease forwards;
}

.announcement.hide {
  animation: annOut 0.25s ease forwards;
}

.ann-author {
  font-weight: 600;
  color: #000;
  display: flex;
  align-items: center;
  gap: 6px;
}

.ann-text {
  font-size: 15px;
  color: #000;
  opacity: 0.9;
}

/* –ó–ï–õ–Å–ù–´–ô –ö–í–ê–î–†–ê–¢ */
.gas-check {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  background: #2ecc71;
  border-radius: 3px;
  font-size: 10px;
  color: white;
  font-weight: 900;
  line-height: 1;
}

@keyframes annIn {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

@keyframes annOut {
  to {
    opacity: 0;
    transform: translateX(-50%) translateY(-20px);
  }
}

#pot {
  font-size: 24px;
  line-height: 24px;
  margin-bottom: 10px;
  text-align: center;
}

.disco {
  animation: discoBg 0.5s infinite alternate;
}

@keyframes discoBg {
  from { background-color: #ff00ff; }
  to { background-color: #00ffff; }
}


.tg-btn {
  display: inline-block;
  padding: 10px 20px;
  background: #0088cc;
  color: white;
  font-weight: bold;
  border-radius: 10px;
  text-decoration: none;
  transition: 0.3s;
}
.tg-btn:hover {
  background: #006699;
}





@keyframes shake {
  0% { transform: translate(0, 0); }
  25% { transform: translate(2px, -2px); }
  50% { transform: translate(-2px, 2px); }
  75% { transform: translate(2px, 2px); }
  100% { transform: translate(0, 0); }
}

.shake {
  animation: shake 0.1s infinite;
}












#plantShop {
  position: fixed;
  top: 70px;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  max-width: 400px;
  max-height: 70vh;
  background:#fff;
  border-radius: 15px;
  padding: 20px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.2);
  overflow-y: auto;
  z-index: 999;
}

#plantShop h3 {
  margin-top: 0;
}

.shop-list {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}

.shop-list button {
  width: 110px;
  margin: 6px;
  font-size: 14px;
}

.hidden {
  display: none;
}


#harvestButton {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #ffb74d;
  color: #333;
  padding: 12px 24px;
  font-size: 16px;
  border: none;
  border-radius: 12px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  cursor: pointer;
  z-index: 1000;
  transition: background 0.3s;
}

#harvestButton:hover {
  background-color: #ffa000;
}


#moneyBar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background-color: #c5e1a5;
  color:  #333;
  font-weight: bold;
  padding: 10px;
  font-size: 18px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  z-index: 1000;
}


#game {
  max-width: 500px;
  margin: auto;
  background: #fff8f0;
  border-radius: 15px;
  padding: 20px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

button {
  margin: 5px;
  padding: 10px;
  border: none;
  background: #8bc34a;
  color: white;
  font-weight: bold;
  border-radius: 10px;
  cursor: pointer;
  transition: 0.3s;
}

button:hover {
  background:  #689f38;
}

#garden {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}

.plot {
  width: 80px;
  height: 80px;
  margin: 5px;
  background:#c8e6c9;
  border: 2px dashed #558b2f;
  border-radius: 10px;
  position: relative;
  font-size: 30px;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
}

.plot.ready {
  background:#fff59d;
}

.tooltip {
  font-size: 10px;
  position: absolute;
  bottom: 0;
  width: 100%;
  background: rgba(255,255,255,0.7);
  border-radius: 0 0 10px 10px;
}

@keyframes growPulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.15); }
  100% { transform: scale(1); }
}

.plot.growing {
  animation: growPulse 1.5s infinite;
}
  </style>

  
</head>
<body>
  <link rel="stylesheet" href="style.css" />

  <div id="game">
    <h1>üåø –í—ã—Ä–∞—Å—Ç–∏ –∏ –ø—Ä–æ–¥–∞–π</h1>
    <div id="moneyBar">
  üí∞ –®–∞–∫–∏–ª–∏: <span id="money">0</span>
  <div id="activeEventsBar"></div>
   
</div>
<!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
<div id="start-screen">
    <div class="logo-container">
        <img src="" alt="." class="logo">
        <p class="press-text">–ù–∞–∂–º–∏—Ç–µ –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å</p>
    </div>
</div>

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
<div id="game-container">
    <!-- –ó–¥–µ—Å—å —Ç–≤–æ–π –∏–≥—Ä–æ–≤–æ–π –∫–æ–¥ -->
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<div id="ramadanBanner" class="ramadan-banner swamp">
  üåô RAMADAN EVENT 2026
  <span class="ramadan-sub">–ó–ê–ö–†–´–¢–û</span>
  <button onclick="openRamadanShop()">–ó–ê–ö–†–´–¢–û</button>
</div>

<div id="ramadanShop" class="hidden">
  <h3>üåô RAMADAN EVENT SHOP</h3>

  <div class="ramadan-pack">
    <p>üéÅ Ramadan Pack ‚Äî 25 000 000 üí∞</p>
    <button onclick="buyRamadanPack(1)">–ö—É–ø–∏—Ç—å</button>
  </div>

  <div class="ramadan-pack">
    <p>‚ú® Ramadan Pack 2 ‚Äî 75 000 000 üí∞</p>
    <button onclick="buyRamadanPack(2)">–ö—É–ø–∏—Ç—å</button>
  </div>

  <button onclick="closeRamadanShop()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>


<audio id="backgroundMusic" loop>
  <source src="https://dl.dropboxusercontent.com/s/bjxm9kwaciies3onzh0ut/Grow-A-Garden-Classic-Easter-Theme-Reupload-1.mp3
" type="audio/">
  –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
</audio>

<div id="statsTab" class="tab" style="display:none;">
  <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
  <p>üå± –ü–æ—Å–∞–∂–µ–Ω–æ: <span id="statsPlanted">0</span></p>
  <p>üåæ –°–æ–±—Ä–∞–Ω–æ: <span id="statsHarvested">0</span></p>
  <p>üí∞ –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: <span id="statsEarned">0</span></p>
  <button onclick="closeTab('statsTab')">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>



    <div id="upgradeShop">
      <h3>üîß –£–ª—É—á—à–µ–Ω–∏—è</h3>
      <button onclick="buySlot()">–î–æ–±–∞–≤–∏—Ç—å –≥—Ä—è–¥–∫—É (15üí∞) <span id="slotCount"></span></button>
      <button onclick="buyWatering()">–ü–æ–ª–∏–≤–∞–ª–∫–∞ üåßÔ∏è (10üí∞)</button>
    </div>

    <button onclick="toggleShop()">üõí –û—Ç–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω</button>

<div id="plantShop" class="hidden">
  <h3>üå± –ú–∞–≥–∞–∑–∏–Ω —Ä–∞—Å—Ç–µ–Ω–∏–π <button onclick="toggleShop()">‚ùå</button></h3>
  <div id="seedButtons" class="shop-list"></div>
</div>


    <h3>üå± –ì—Ä—è–¥–∫–∏</h3>
    <div id="garden"></div>
  </div>

<div id="leaderboardBox">
  <h3>üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h3>

  <div id="leaderboardTabs">
    <button onclick="setLeaderboardMode('money')">üí∞ –®–∞–∫–∏–ª–∏</button>
    <button onclick="setLeaderboardMode('rebirths')">üîÅ –ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è</button>
  </div>

  <div id="leaderboardList">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
</div>

<div id="redeemSection">
  <h3>üéÅ –ö–æ–¥—ã</h3>
  <input type="text" id="redeemInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥">
  <button onclick="redeemCode()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
  <p id="redeemMessage"></p>
</div>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>


<button onclick="tryRebirth()">üîÑ –ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ</button>


  <a href="https://t.me/+YaDJr4kBFOUyYjEy" target="_blank" class="tg-btn">–ù–∞—à Telegram üì≤</a>

</div>

  <script src="game.js"></script>

  <button id="harvestButton" onclick="harvestAll()">–°–æ–±—Ä–∞—Ç—å –≤—Å—ë üåæ</button>

<div id="playerIdBox" style="
  margin-top: 8px;
  font-size: 12px;
  color: #555;
  text-align: center;
">
  ID: <span id="playerIdText"></span>
</div>

<div id="recordsScreen" style="display:none; padding: 20px;">
  <h2>üèÜ –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ—Ä–¥–æ–≤</h2>
  <p>üîù –õ—É—á—à–∞—è —Å—É–º–º–∞ —à–∞–∫–∏–ª–µ–π: <span id="bestMoneyDisplay">0</span> üí∞</p>
  <button onclick="hideRecords()">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
</div>

<div id="adminPanel" style="
display:none;
position:fixed;
bottom:20px;
right:20px;
background:#111;
color:white;
padding:16px;
border-radius:14px;
z-index:99999;
width:260px;
">
  <h3>üëë Admin Panel</h3>

  <input id="adminMsg" placeholder="Announcement" style="width:100%">
  <button onclick="sendAnnouncement()">Send</button>

  <hr>

<button onclick="adminStartLuck(2)">Luck x2</button>
<button onclick="adminStartLuck(4)">Luck x4</button>
<button onclick="adminStartDisco()">Disco</button>
<button onclick="adminStartLuckyRain()">Lucky Packs</button>
<button onclick="adminStartMutationSurge()">Mutation Surge</button>
<button onclick="adminStartRamadan()">Ramadan</button>
<button onclick="adminStartBirthday()">B-Day</button>
<button onclick="startSnapEvent()">Aunxzz Snap</button>


<button onclick="stopAllEvents()" style="background:red;">
  ‚õî Stop All Events
</button>

  <div id="onlineCount" style="
  margin-top: 12px;
  font-weight: bold;
  color: #00ff88;
  font-size: 16px;
">
  –û–Ω–ª–∞–π–Ω —Å–µ–π—á–∞—Å: 0
</div>

</div>
<div id="ramadanRoulette" class="hidden">
  <div id="rouletteItem">?</div>
</div>

<p id="recordUpdateTimer" style="font-size: 12px; color: gray; margin-top: 10px;">
  V210 <span id="updateTime"></span>
</p>

  <script>
    let money = parseInt(localStorage.getItem("money")) || 20;
let slots = parseInt(localStorage.getItem("slots")) || 3;
let watering = parseInt(localStorage.getItem("watering")) || 0;
let garden = JSON.parse(localStorage.getItem("garden")) || [];
let displayedMoney = money;
let bestMoney = parseInt(localStorage.getItem("bestMoney")) || 0;
let rouletteSpinsToday =
  parseInt(localStorage.getItem("rouletteSpinsToday")) || 0;
let lastRouletteDate = localStorage.getItem("lastRouletteDate") || "";
let currentPlotSkin = localStorage.getItem("currentPlotSkin") || "default";
let stats = { planted: 0, harvested: 0, earned: 0 };
let currentGlobalEvent = null;

function updateStatsUI() {
  document.getElementById("statsPlanted").textContent = stats.planted;
  document.getElementById("statsHarvested").textContent = stats.harvested;
  document.getElementById("statsEarned").textContent = stats.earned;
}

function setSkin(skin) {
  currentPlotSkin = skin;
  localStorage.setItem("currentPlotSkin", currentPlotSkin);
  updateUI();
}


const music = document.getElementById("backgroundMusic");

// –í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É
music.play();

// –ü–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
music.pause();

const maxSlots = 500; // –º–∞–∫—Å–∏–º—É–º —Å–ª–æ—Ç–æ–≤

const seeds = [
  { name: "–õ—É–∫", emoji: "üßÖ", price: 2, growTime: 3000, rarity: "—Å—Ç–∞—Ä—Ç–æ–≤–æ–µ",  },
  { name: "–ú–æ—Ä–∫–æ–≤—å", emoji: "ü•ï", price: 6, growTime: 6000, rarity: "—Ä–µ–¥–∫–æ–µ", favorite: false
 },

  {
    name: "–õ–∏–º–æ–Ω",
    emoji: "üçã",
    price: 8,
    growTime: 6000,
    rarity: "—Ä–µ–¥–∫–æ–µ",
    favorite: false

  },

  {
    name: "–°–≤–µ–∫–ª–∞",
    emoji: "üç†",
    price: 10,
    growTime: 8000,
    rarity: "—Ä–µ–¥–∫–æ–µ",
    favorite: false

  },
  {
    name: "–ê—Ä–±—É–∑",
    emoji: "üçâ",
    price: 15,
    growTime: 10000,
    rarity: "—Ä–µ–¥–∫–æ–µ",
    favorite: false

  },

  {
    name: "–ü–∞–ø—Ä–∏–∫–∞",
    emoji: "üå∂Ô∏è",
    price: 19,
    growTime: 11000,
    rarity: "—Ä–µ–¥–∫–æ–µ",
    favorite: false

  },
  {
    name: "–ö–ª—É–±–Ω–∏–∫–∞",
    emoji: "üçì",
    price: 23,
    growTime: 12000,
    rarity: "—Ä–µ–¥–∫–æ–µ",
    favorite: false

  },


  {
    name: "–ü–æ–º–∏–¥–æ—Ä",
    emoji: "üçÖ",
    price: 30,
    growTime: 13500,
    rarity: "—ç–ø–∏—á–µ—Å–∫–æ–µ",
    favorite: false

  },

  {
    name: "–ë–∞–Ω–∞–Ω",
    emoji: "üçå",
    price: 35,
    growTime: 14500,
    rarity: "—ç–ø–∏—á–µ—Å–∫–æ–µ",
    favorite: false

  },

  {
    name: "–ì—Ä—É—à–∞",
    emoji: "üçê",
    price: 40,
    growTime: 15500,
    rarity: "—ç–ø–∏—á–µ—Å–∫–æ–µ",
    favorite: false

  },

  {
    name: "–ê–ø–µ–ª—å—Å–∏–Ω",
    emoji: "üçä",
    price: 50,
    growTime: 17000,
    rarity: "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ",
    favorite: false

  },

  {
    name: "–ö–æ–∫–æ—Å",
    emoji: "ü••",
    price: 55,
    growTime: 18000,
    rarity: "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ",
    favorite: false

  },


  {
    name: "–ö–∞–ø—É—Å—Ç–∞",
    emoji: "ü•¨",
    price: 65,
    growTime: 19500,
    rarity: "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ",
    favorite: false

  },

  {
    name: "–ú–∞–Ω–¥–∞—Ä–∏–Ω",
    emoji: "üçä",
    price: 70,
    growTime: 20500,
    rarity: "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ",
    favorite: false

  },


  {
    name: "–í–∏—à–Ω—è",
    emoji: "üçí",
    price: 550,
    growTime: 23000,
    rarity: "–º–∏—Ñ–∏—á–µ—Å–∫–æ–µ",
    favorite: false

  },

  {
    name: "–†–∞—Å—Ç–µ–Ω–∏–µ –≤–µ—á–Ω–æ—Å—Ç–∏",
    emoji: "‚ôæÔ∏èüåø",
    price: 999,
    growTime: 25000,
    rarity: "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–æ–µ",
    favorite: false

  },
 
  {
    name: "–ì–æ–ª—É–±–∏–∫–∞",
    emoji: "ü´ê",
    price: 1500,
    growTime: 50000,
    rarity: "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–æ–µ",
    favorite: false

  },

  {
    name: "–ë–∞–Ω–∞–Ω",
    emoji: "üçå",
    price: 1000000,
    growTime: 10000000,
    rarity: "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ–∫–æ–µ",
    favorite: false

  },
    {
    name: "–õ–æ—Ç–æ—Å",
    emoji: "ü™∑",
    price:  100000000,
    growTime: 10000000,
    rarity: "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–æ–µ",
    favorite: false

  },
{ 
  name: "–ö–∞–∫—Ç—É—Å", 
  emoji: "üåµ", 
  price: 900000000, 
  growTime: 80000000,  // 60 —Å–µ–∫—É–Ω–¥
  rarity: "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–æ–µ" 
},
{ 
  name: "–í—É–¥ —Ü–∏–∫–∞—Å", 
  emoji: "üå∫", 
  price: 900000000, 
  growTime: 80000000,  // 60 —Å–µ–∫—É–Ω–¥
  rarity: "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–æ–µ" 
},

];

const rarityOrder = {
  –æ–±—ã—á–Ω–æ–µ: 1,
  —Ä–µ–¥–∫–æ–µ: 2,
  —ç–ø–∏—á–µ—Å–∫–æ–µ: 3,
  –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ: 4,
  –º–∏—Ñ–∏—á–µ—Å–∫–æ–µ: 5,
};
// üéÅ –°–ø–∏—Å–æ–∫ –∫–æ–¥–æ–≤
// –¢–∏–ø –º–æ–∂–µ—Ç –±—ã—Ç—å: "money" –∏–ª–∏ "plant"
const redeemCodes = {
  "WDNSDAYADMINABUSE": { type: "money", value: 3000000000 },
  "lol": { type: "money", value: 67 },
  "NEWYEAR2026": { type: "money", value:   2600000000 },

  // –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–∞—ë—Ç —Ä–∞—Å—Ç–µ–Ω–∏–µ:
 "AUNXZZPAVELABUSE": {
    type: "plant",
    value: {
      name: "–ö–∞–∫—Ç—É—Å-—Ñ–µ–π–≤–µ—Ä–∫",
      emoji: "üéÜüåµ",
      price: 50000000000,
      growTime: 10000000,
      rarity: "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–æ–µ"
    },
 },
  "YAY": {
    type: "plant",
    value: {
      name: "–ì—Ä–æ–∑–æ–≤–æ–π –≥—Ä–∏–±",
      emoji: "üå©Ô∏èüçÑ",
      price: 5000000000,
      growTime:  10000000,
      rarity: "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–æ–µ"
    }
  }
};

// –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–¥—ã (—á—Ç–æ–±—ã –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–ª–∏—Å—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞—Ö–æ–¥–∞)
let usedCodes = JSON.parse(localStorage.getItem("usedCodes")) || [];

// üí¨ –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–¥–∞
function redeemCode() {
  const input = document.getElementById("redeemInput").value.trim().toUpperCase();
  const message = document.getElementById("redeemMessage");

  if (!input) {
    message.textContent = "‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥!";
    return;
  }

  if (usedCodes.includes(input)) {
    message.textContent = "‚ö†Ô∏è –≠—Ç–æ—Ç –∫–æ–¥ —É–∂–µ –±—ã–ª –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!";
    return;
  }

  const codeData = redeemCodes[input];

  if (!codeData) {
    message.textContent = "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!";
    return;
  }

  // üí∞ –ï—Å–ª–∏ –∫–æ–¥ ‚Äî –Ω–∞ –¥–µ–Ω—å–≥–∏
  if (codeData.type === "money") {
    money += codeData.value;
    message.textContent = `‚úÖ –ö–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –í—ã –ø–æ–ª—É—á–∏–ª–∏ ${codeData.value.toLocaleString()} üí∞`;
  }

  // üå± –ï—Å–ª–∏ –∫–æ–¥ ‚Äî –Ω–∞ —Ä–∞—Å—Ç–µ–Ω–∏–µ
  else if (codeData.type === "plant") {
    const plantData = codeData.value;

    // –ù–∞—Ö–æ–¥–∏–º –ø—É—Å—Ç—É—é –≥—Ä—è–¥–∫—É
    const emptyIndex = garden.findIndex(p => !p);
    if (emptyIndex === -1) {
      message.textContent = "‚ùå –ù–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö –≥—Ä—è–¥–æ–∫ –¥–ª—è –ø–æ—Å–∞–¥–∫–∏ —Ä–∞—Å—Ç–µ–Ω–∏—è!";
    } else {
      garden[emptyIndex] = {
        ...plantData,
        start: Date.now(),
        time: plantData.growTime,
        ready: false
      };
      growPlant(emptyIndex);
      message.textContent = `‚úÖ –í—ã –ø–æ–ª—É—á–∏–ª–∏ —Ä–∞—Å—Ç–µ–Ω–∏–µ: ${plantData.emoji} ${plantData.name}!`;
    }
  }

  // ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  usedCodes.push(input);
  localStorage.setItem("usedCodes", JSON.stringify(usedCodes));
  save(); // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
  updateUI();
}

function save() {
  localStorage.setItem("money", money);
  localStorage.setItem("slots", slots);
  localStorage.setItem("watering", watering);
  localStorage.setItem("garden", JSON.stringify(garden));
  if (money > bestMoney) {
    bestMoney = money;
    localStorage.setItem("bestMoney", bestMoney);
  }
}

function updateUI() {
  document.getElementById("money").textContent = money;
  renderGarden();
  updateLeaderboard();

}

function renderGarden() {
  const gardenDiv = document.getElementById("garden");
  gardenDiv.innerHTML = "";

  for (let i = 0; i < slots; i++) {
    const plot = document.createElement("div");
plot.className = "plot";
if (currentPlotSkin === "night") {
  plot.classList.add("night-skin");
}



    const plant = garden[i];
    if (plant) {
      plot.textContent = plant.emoji;
      if (!plant.ready) {
        plot.classList.add("growing");
      }
      if (plant.ready) {
        plot.innerHTML += `<div class="tooltip">–ì–æ—Ç–æ–≤–æ! (${plant.name})</div>`;
        plot.onclick = () => {
         money += Math.floor(plant.price * 1.5 * getRebirthBonus());
          garden[i] = null;
          updateUI();
          save();
        };
      } else {
        const percent = Math.floor(
          ((Date.now() - plant.start) / plant.time) * 100,
        );
        plot.innerHTML += `<div class="tooltip">${plant.rarity} ‚Ä¢ ${percent}%</div>`;
      }
    } else {
      plot.onclick = () => plantSeed(i);
    }

    gardenDiv.appendChild(plot);
  }
}

function renderSeeds() {
  const rarityOrder = {
    –æ–±—ã—á–Ω–æ–µ: 1,
    —Ä–µ–¥–∫–æ–µ: 2,
    —ç–ø–∏—á–µ—Å–∫–æ–µ: 3,
    –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ: 4,
    –º–∏—Ñ–∏—á–µ—Å–∫–æ–µ: 5,
  };

  seeds.sort((a, b) => rarityOrder[a.rarity] - rarityOrder[b.rarity]);

  const seedButtons = document.getElementById("seedButtons");
  seedButtons.innerHTML = "";
  seeds.forEach((seed, index) => {
    const btn = document.createElement("button");
    btn.textContent = `${seed.emoji} ${seed.name} (${seed.price}üí∞)`;
    btn.onclick = () => {
      selectedSeed = index;
      toggleShop();
    };
    seedButtons.appendChild(btn);
  });
}

let selectedSeed = null;

function plantSeed(i) {
  if (selectedSeed === null) return;
  const seed = seeds[selectedSeed];
  if (money < seed.price) return;

  money -= seed.price;
  const time = seed.growTime - watering * 1000;
  garden[i] = {
    ...seed,
    start: Date.now(),
    time: time,
    ready: false,
  };

  growPlant(i);
  updateUI();
  save();
  updateQuestProgress(0, 1); // –ü–æ—Å–∞–¥–∫–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è
}

function growPlant(i) {
  const interval = setInterval(() => {
    const plant = garden[i];
    if (!plant) return clearInterval(interval);
    if (Date.now() - plant.start >= plant.time) {
    const timePassed = Date.now() - plant.start;
const growTime = boosts.speed ? plant.time * 0.5 : plant.time; // ‚ö° –£—Å–∫–æ—Ä–∏—Ç–µ–ª—å —Ä–æ—Å—Ç–∞
if (timePassed >= growTime) {
// üé® –£–ª—É—á—à–µ–Ω–Ω—ã–µ –º—É—Ç–∞—Ü–∏–∏
let chance = 0.05;

// –µ—Å–ª–∏ Mutation Surge –∞–∫—Ç–∏–≤–µ–Ω
if (
  activeEvents.mutationSurge.active &&
  plant.start >= activeEvents.mutationSurge.startedAt
) {
  chance = 0.6;
}

if (Math.random() < getMutationChance(chance)) {
 // 5% —à–∞–Ω—Å –Ω–∞ –º—É—Ç–∞—Ü–∏—é
  let type;
let roll = Math.random();

if (roll < 0.03) {
  type = ["silver", "gold"][Math.floor(Math.random() * 2)];
} else if (roll < 0.049) {
  type = "rainbow";
} else {
  type = "cosmic";
}



  if (type === "silver") {
    plant.price *= 2;
    plant.emoji = "ü•à" + plant.emoji;
    plant.mutation = "–°–µ—Ä–µ–±—Ä—è–Ω–æ–µ üåü (√ó2 –¥–µ–Ω—å–≥–∏)";
  }
  if (type === "gold") {
    plant.price *= 5;
    plant.emoji = "ü•á" + plant.emoji;
    plant.mutation = "–ó–æ–ª–æ—Ç–æ–µ üí∞ (√ó5 –¥–µ–Ω—å–≥–∏)";
  }
  if (type === "rainbow") {
    plant.price *= 10;
    plant.emoji = "üåà" + plant.emoji;
    plant.mutation = "–†–∞–¥—É–∂–Ω–æ–µ üåà (√ó10 –¥–µ–Ω—å–≥–∏ + +50% —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–æ—Å—Ç–∞)";
    plant.growTime = Math.floor(plant.growTime * 0.5); // –±—ã—Å—Ç—Ä–µ–µ —Ä–∞—Å—Ç—ë—Ç
  }
  if (type === "cosmic") {
    plant.price *= 50;
    plant.emoji = "‚ú®" + plant.emoji;
    plant.mutation = "–ö–æ—Å–º–∏—á–µ—Å–∫–æ–µ üöÄ (√ó50 –¥–µ–Ω—å–≥–∏ + –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç)";
    plant.ready = true; // —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤–æ
  }
  
}

  plant.ready = true;
  updateUI();
  save();
  clearInterval(interval);
}

    }
  }, 1000);
}

function buySlot() {
  if (slots >= maxSlots) {
    alert("–ú–∞–∫—Å–∏–º—É–º –≥—Ä—è–¥–æ–∫ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç! üåæ");
    return;
  }

  if (money >= 15) {
    money -= 15;
    slots += 1;
    garden.push(null);
    updateUI();
    save();
  } else {
    alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —à–∞–∫–∏–ª–µ–π!");
  }
}

function buyWatering() {
  if (money >= 10) {
    money -= 10;
    watering += 1;
    updateUI();
    save();
  }
}

function loadGrowth() {
  garden.forEach((plant, i) => {
    if (plant && !plant.ready) {
      growPlant(i);
    }
  });
}



function animateMoney() {
  const display = document.getElementById("money");
  if (!display) return;

  if (displayedMoney !== money) {
    displayedMoney += (money - displayedMoney) * 0.1;
    if (Math.abs(money - displayedMoney) < 0.5) {
      displayedMoney = money;
    }
    display.textContent = Math.floor(displayedMoney);
  }

  requestAnimationFrame(animateMoney);


}

function harvestAll() {
  let harvested = false;
  for (let i = 0; i < garden.length; i++) {
    const plant = garden[i];
    if (plant && plant.ready) {
     money += Math.floor(plant.price * 1.5 * getRebirthBonus());

      garden[i] = null;
      harvested = true;
    }
  }
  if (harvested) {
    updateUI();
    save();
  } else {
    alert("–ù–µ—Ç –≥–æ—Ç–æ–≤—ã—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π! üå±");
  }
  updateQuestProgress(1, 1); // –°–±–æ—Ä —É—Ä–æ–∂–∞—è

}

function toggleShop() {
  const shop = document.getElementById("plantShop");
  shop.classList.toggle("hidden");
}

function showRecords() {
  document.getElementById("game").style.display = "none";
  document.getElementById("recordsScreen").style.display = "block";
  document.getElementById("bestMoneyDisplay").textContent = bestMoney;
}

function hideRecords() {
  document.getElementById("recordsScreen").style.display = "none";
  document.getElementById("game").style.display = "block";
}

function startRecordUpdateTimer(seconds) {
  const timerDisplay = document.getElementById("updateTime");

  function update() {
    const min = Math.floor(seconds / 60)
      .toString()
      .padStart(2, "0");
    const sec = (seconds % 60).toString().padStart(2, "0");
    timerDisplay.textContent = `${min}:${sec}`;

    if (seconds <= 0) {
      clearInterval(timerInterval);
      timerDisplay.textContent = "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...";
      // –º–æ–∂–µ—à—å —Ç—É—Ç –≤—ã–∑–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —Å–∫—Ä—ã—Ç—å
    }

    seconds--;
  }

  update();

  const timerInterval = setInterval(update, 1000);
}

function spinRoulette() {
  const today = new Date().toDateString();

  // –°–±—Ä–æ—Å –µ—Å–ª–∏ –Ω–æ–≤—ã–π –¥–µ–Ω—å
  if (lastRouletteDate !== today) {
    rouletteSpinsToday = 0;
    lastRouletteDate = today;
    localStorage.setItem("lastRouletteDate", today);
    localStorage.setItem("rouletteSpinsToday", rouletteSpinsToday);
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞
  if (rouletteSpinsToday >= 3) {
    alert("‚ùå –°–µ–≥–æ–¥–Ω—è –ª–∏–º–∏—Ç –ø—Ä–æ–∫—Ä—É—Ç–æ–∫ –∏—Å—á–µ—Ä–ø–∞–Ω (3/3). –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞!");
    return;
  }

  if (money < 5_000) {
    alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –®–∞–∫–∏–ª–µ–π!");
    return;
  }

  money -= 5_000;
  save();
  updateUI();

  const text = document.getElementById("rouletteText");
  text.textContent = "üé≤ –†—É–ª–µ—Ç–∫–∞ –∫—Ä—É—Ç–∏—Ç—Å—è...";
  text.classList.add("shake");

  const rewards = [
    { amount: 10_000, chance: 55 },
    { amount: 50_000, chance: 50 },
    { amount: 1_000_000, chance: 35 },
    { amount: 10_000_000, chance: 20 },
    { amount: 50_000_000, chance: 10 },
    { amount: 100_000_000, chance: 7 },
    { amount: 500_000_000, chance: 5 },
    { amount: 1_000_000_000, chance: 1 },
  ];

  setTimeout(() => {
    text.classList.remove("shake");

    let roll = Math.random() * 100;
    let sum = 0;
    let reward = 0;
    for (let r of rewards) {
      sum += r.chance;
      if (roll <= sum) {
        reward = r.amount;
        break;
      }
    }

    text.textContent = `üéâ –¢—ã –≤—ã–∏–≥—Ä–∞–ª ${reward.toLocaleString()} –®–∞–∫–∏–ª–µ–π!`;
    money += reward;
    save();
    updateUI();

    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
    rouletteSpinsToday++;
    localStorage.setItem("rouletteSpinsToday", rouletteSpinsToday);
  }, 2000);
}

let boosts = {
  speed: false,
  money: false,
  extraSpin: 0,
};

function buyBoost(type, duration, cost) {
  if (money >= cost) {
    money -= cost;
    activateBoost(type, duration);
    save();
    updateUI();
  } else {
    alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –®–∞–∫–∏–ª–µ–π!");
  }
}

function activateBoost(type, duration) {
  if (type === "speed") {
    boosts.speed = true;
    setTimeout(() => (boosts.speed = false), duration);
    alert("‚ö° –£—Å–∫–æ—Ä–∏—Ç–µ–ª—å —Ä–æ—Å—Ç–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–∞ 10 –º–∏–Ω—É—Ç!");
  }
  if (type === "extraSpin") {
    boosts.extraSpin += 1;
    alert("üé≤ –í—ã –ø–æ–ª—É—á–∏–ª–∏ +1 –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ä—É–ª–µ—Ç–∫–∏!");
  }
}


let rebirths = parseInt(localStorage.getItem("rebirths")) || 0;

function tryRebirth() {
  if (money >= 999_000_000_000) {
    if (confirm("‚ö° –ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ! –í—Å—ë —Å–±—Ä–æ—Å–∏—Ç—Å—è, –Ω–æ –∑–∞—Ä–∞–±–æ—Ç–∫–∏ —É–≤–µ–ª–∏—á–∞—Ç—Å—è.")) {
      rebirths++;
      localStorage.setItem("rebirths", rebirths);
      money = 20;
      slots = 3;
      garden = [];
      watering = 0;
      save();
      updateUI();
      alert("‚ú® –¢—ã —Å–¥–µ–ª–∞–ª –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ! –í—Å–µ–≥–æ: " + rebirths);
    }
  } else {
    alert("‚ùå –ù—É–∂–Ω–æ 999 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –¥–ª—è –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è!");
  }
  
updateLeaderboard();

}

// –±–æ–Ω—É—Å –¥–æ—Ö–æ–¥–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ
function getRebirthBonus(multiplier = 1) {
  return 1 + rebirths * 0.1;
}









const bgMusic = document.getElementById("bg-music");

document.addEventListener("click", () => {
  if (bgMusic.paused) {
    bgMusic.play();
  }
});

const startScreen = document.getElementById("start-screen");
const gameContainer = document.getElementById("game-container");

startScreen.addEventListener("click", () => {
  startScreen.style.display = "none";
  gameContainer.style.filter = "blur(0)";
});


function openTab(tabName) {
  let tabs = document.getElementsByClassName("tab");
  for (let i = 0; i < tabs.length; i++) {
    tabs[i].style.display = "none";
  }
  document.getElementById(tabName + "Tab").style.display = "block";
}


function closeSkinsTab() {
  // —Å–∫—Ä—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É —Å–∫–∏–Ω–æ–≤
  document.getElementById("skinsTab").style.display = "none";
  // –≤–æ–∑–≤—Ä–∞—â–∞–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞–≥–∞–∑–∏–Ω
  openTab("shop");
}


const firebaseConfig = {
  apiKey: "AIzaSyC4tqxiAlLaPSqULFANQoK3KjgVvemuM90",
  authDomain: "growandsell-online.firebaseapp.com",
  databaseURL: "https://growandsell-online-default-rtdb.firebaseio.com",
  projectId: "growandsell-online",
  storageBucket: "growandsell-online.firebasestorage.app",
  messagingSenderId: "225873934463",
  appId: "1:225873934463:web:9539354889c0152b4ba74a"
};
let seenAnnouncements = JSON.parse(
  localStorage.getItem("seenAnnouncements") || "[]"
);


firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let playerId = localStorage.getItem("playerId");

if (!playerId) {
  playerId = "player-" + Math.random().toString(36).slice(2, 10);
  localStorage.setItem("playerId", playerId);
}

document.getElementById("playerIdText").textContent = playerId;

const onlineRef = db.ref("online/" + playerId);
onlineRef.set(true);
onlineRef.onDisconnect().remove();

document.getElementById("playerIdText").textContent = playerId;
const ADMIN_ID = "player_1765190919130_203";
if (playerId === ADMIN_ID) {
  document.getElementById("adminPanel").style.display = "block";
}

function sendAnnouncement() {
  const text = document.getElementById("adminMsg").value.trim();
  if (!text) return;

  const id = "msg_" + Date.now();

  db.ref("announcements/" + id).set({
    id,
    text,
    author: "aunxzz",
    createdAt: Date.now(),
    duration: 8000
  });

  document.getElementById("adminMsg").value = "";
}

db.ref("announcements").on("child_added", snap => {
  const data = snap.val();
  if (!data) return;

  if (seenAnnouncements.includes(data.id)) return;

  showAnnouncement(data);
});

function showAnnouncement(data) {
  seenAnnouncements.push(data.id);
  localStorage.setItem(
    "seenAnnouncements",
    JSON.stringify(seenAnnouncements)
  );

  const box = document.createElement("div");
  box.className = "announcement";

  box.innerHTML = `
    <div class="ann-author">
      ${data.author}
      <span class="gas-check">‚úî</span>
    </div>
    <div class="ann-text">${data.text}</div>
  `;

  document.body.appendChild(box);

  setTimeout(() => {
    box.classList.add("hide");
    setTimeout(() => box.remove(), 600);
  }, data.duration || 8000);
}

let activeEvents = {
  luck: {
    active: false,
    multiplier: 1 // x2 x4 x6 x8
  },
  disco: {
    active: false
  },
  luckyRain: {
    active: false
  },
  mutationSurge: {
  active: false,
  startedAt: 0
},
global: {
  type: null,
  endAt: 0
}


};
function getMutationChance(baseChance) {
  let chance = baseChance;

  if (activeEvents.luck.active) {
    chance *= activeEvents.luck.multiplier;
  }

  return chance;
}

function startLuckEvent(multiplier = 2, duration = 300) {
  activeEvents.luck.active = true;
  activeEvents.luck.multiplier = multiplier;

  setTimeout(() => {
    activeEvents.luck.active = false;
    activeEvents.luck.multiplier = 1;
  }, duration * 1000);
}
if (activeEvents.disco.active) {
  luckMultiplier *= 1.5;
}
function startDiscoEvent(duration = 300) {
  if (currentGlobalEvent && currentGlobalEvent !== "disco") return;
currentGlobalEvent = "disco";
  activeEvents.disco.active = true;
  document.body.classList.add("disco");

  setTimeout(() => {
    activeEvents.disco.active = false;
    document.body.classList.remove("disco");
  }, duration * 1000);
}
function giveLuckyPackReward() {
  const roll = Math.random();

  if (roll < 0.4) {
    money += 50000;
  } else if (roll < 0.7) {
    money += 250000;
  } else {
    giveRandomPlantWithMutation();
  }

  updateUI();
  save();
}
function spawnLuckyPack() {
  const pack = document.createElement("div");
  pack.textContent = "üéÅ";
  pack.style.cssText = `
    position:fixed;
    top:-40px;
    left:${Math.random() * 90}%;
    font-size:38px;
    cursor:pointer;
    z-index:99999;
    transition:top 3s linear;
  `;

  document.body.appendChild(pack);
  setTimeout(() => pack.style.top = "110%", 10);

  pack.onclick = () => {
    giveLuckyPackReward();
    pack.remove();
  };

  setTimeout(() => pack.remove(), 3500);
}
function adminStartLuck(multiplier) {
  const duration = prompt("–°–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥? (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 300)", "300");
  const time = parseInt(duration) || 300;

  db.ref("events/luck").set({
    active: true,
    multiplier,
    endAt: Date.now() + time * 1000
  });
}

function adminStartDisco() {

  const duration = prompt("–°–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥? (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 300)", "300");
  const time = parseInt(duration) || 300;

  db.ref("events/disco").set({
    active: true,
    endAt: Date.now() + time * 1000
  });
}

function adminStartLuckyRain() {
  const duration = prompt("–°–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥? (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60)", "60");
  const time = parseInt(duration) || 60;

  db.ref("events/luckyRain").set({
    active: true,
    endAt: Date.now() + time * 1000
  });
}
db.ref("events").on("value", snap => {
  const events = snap.val();
  const bar = document.getElementById("activeEventsBar");
  bar.innerHTML = "";

  if (!events) {
    activeEvents.luck.active = false;
    activeEvents.disco.active = false;
    activeEvents.luckyRain.active = false;
    document.body.classList.remove("disco");
    return;
  }

  // LUCK
  if (events.luck?.active && Date.now() < events.luck.endAt) {
    activeEvents.luck.active = true;
    activeEvents.luck.multiplier = events.luck.multiplier;
    renderEventIcon("luck", events.luck.endAt, "üçÄ", "luckIcon");
  } else {
    activeEvents.luck.active = false;
    activeEvents.luck.multiplier = 1;
  }

  // DISCO
  if (events.disco?.active && Date.now() < events.disco.endAt) {
    activeEvents.disco.active = true;
    document.body.classList.add("disco");
    renderEventIcon("disco", events.disco.endAt, "ü™©", "discoIcon");
  } else {
    activeEvents.disco.active = false;
    document.body.classList.remove("disco");
  }

  // RAIN
  if (events.luckyRain?.active && Date.now() < events.luckyRain.endAt) {
    activeEvents.luckyRain.active = true;
    startLuckyRainVisual(events.luckyRain.endAt);
    renderEventIcon("rain", events.luckyRain.endAt, "üåßÔ∏è", "rainIcon");
  } else {
    activeEvents.luckyRain.active = false;
  }

  // MUTATION SURGE
if (events.mutationSurge?.active && Date.now() < events.mutationSurge.endAt) {
  activeEvents.mutationSurge.active = true;
  activeEvents.mutationSurge.startedAt = events.mutationSurge.startAt;
  renderEventIcon("mutation", events.mutationSurge.endAt, "üß¨", "luckIcon");
} else {
  activeEvents.mutationSurge.active = false;
}
// RAMADAN
if (events.ramadan?.active && Date.now() < events.ramadan.endAt) {
  startRamadanVisual(events.ramadan.endAt);
  renderEventIcon("ramadan", events.ramadan.endAt, "üåô", "luckIcon");
}

// BIRTHDAY
if (events.birthday?.active && Date.now() < events.birthday.endAt) {
  startBirthdayVisual(events.birthday.endAt);
  renderEventIcon("birthday", events.birthday.endAt, "üéÇ", "rainIcon");
}

});


let luckyRainInterval = null;

function startLuckyRainVisual(endAt) {
  if (luckyRainInterval) return;

  luckyRainInterval = setInterval(() => {
    if (Date.now() >= endAt) {
      clearInterval(luckyRainInterval);
      luckyRainInterval = null;
      return;
    }
    spawnLuckyPack();
  }, 800);
}

db.ref("online").on("value", snap => {
  const users = snap.val();
  const count = users ? Object.keys(users).length : 0;
  document.getElementById("onlineCount").textContent =
    "–û–Ω–ª–∞–π–Ω —Å–µ–π—á–∞—Å: " + count;
});
function renderEventIcon(name, endAt, emoji, className) {
  const bar = document.getElementById("activeEventsBar");

  const div = document.createElement("div");
  div.className = "eventIcon " + className;
  div.id = "event_" + name;
  div.textContent = emoji;

  const tooltip = document.createElement("div");
  tooltip.className = "eventTooltip";
  div.appendChild(tooltip);

  const interval = setInterval(() => {
    const left = Math.floor((endAt - Date.now()) / 1000);

    if (left <= 0) {
      createEndFlash();
      clearInterval(interval);
      div.remove();
      return;
    }

    tooltip.textContent = left + " —Å–µ–∫.";
  }, 500);

  bar.appendChild(div);
}

function stopAllEvents() {
  db.ref("events").set({});
}
function adminStartMutationSurge() {
  const duration = prompt("–°–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥?", "300");
  const time = parseInt(duration) || 300;

  db.ref("events/mutationSurge").set({
    active: true,
    startAt: Date.now(),
    endAt: Date.now() + time * 1000
  });
}
function adminStartRamadan() {
  const duration = prompt("–°–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥? (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 300)", "300");
  const time = parseInt(duration) || 300;

  db.ref("events/ramadan").set({
    active: true,
    endAt: Date.now() + time * 1000
  });
}

function adminStartBirthday() {
  const duration = prompt("–°–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥? (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 120)", "120");
  const time = parseInt(duration) || 120;

  db.ref("events/birthday").set({
    active: true,
    endAt: Date.now() + time * 1000
  });
}

let ramadanInterval = null;

function startRamadanVisual(endAt) {
  if (currentGlobalEvent && currentGlobalEvent !== "ramadan") return;
currentGlobalEvent = "ramadan";
  if (ramadanInterval) return;
  stopAllVisuals();
  document.body.classList.add("ramadan-bg");
  ramadanInterval = setInterval(() => {
    if (Date.now() >= endAt) {
      clearInterval(ramadanInterval);
      ramadanInterval = null;
      document.body.classList.remove("ramadan-bg");
      return;
    }

    const light = document.createElement("div");
    light.className = "ramadan-light";
    light.style.left = Math.random() * 100 + "%";
    light.style.top = Math.random() * 100 + "%";
    document.body.appendChild(light);

    setTimeout(() => light.remove(), 2000);

  }, 300);
}
let birthdayInterval = null;

function startBirthdayVisual(endAt) {
  if (currentGlobalEvent && currentGlobalEvent !== "birthday") return;
currentGlobalEvent = "birthday";
  if (birthdayInterval) return;
  stopAllVisuals();
  document.body.classList.add("birthday-bg");

  const flash = document.createElement("div");
  flash.className = "flash-screen";
  document.body.appendChild(flash);
  setTimeout(() => flash.remove(), 500);

  const left = document.createElement("div");
  left.className = "birthday-text left-text";
  left.textContent = "üéâ HAPPY BIRTHDAY üéâ";

  const right = document.createElement("div");
  right.className = "birthday-text right-text";
  right.textContent = "üéâ HAPPY BIRTHDAY üéâ";

  document.body.appendChild(left);
  document.body.appendChild(right);

  birthdayInterval = setInterval(() => {
    if (Date.now() >= endAt) {
      clearInterval(birthdayInterval);
      document.body.classList.remove("birthday-bg");
      left.remove();
      right.remove();
      return;
    }

    firework() // –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫

  }, 400);
}
function startSnapEvent() {
  stopAllVisuals();

  document.body.classList.add("glitch");

  setTimeout(() => {
    document.body.classList.remove("glitch");

    const snap = document.createElement("div");
    snap.style.cssText = `
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:90px;
      z-index:99999;
    `;
    snap.textContent = "üëå";
    document.body.appendChild(snap);

    setTimeout(() => {

      const gray = document.createElement("div");
      gray.className = "gray-screen-overlay";
      document.body.appendChild(gray);

      snap.remove();

      setTimeout(() => {
        gray.remove();

        // –∑–∞–ø—É—Å–∫–∞–µ–º –º–æ—â–Ω—ã–µ –∏–≤–µ–Ω—Ç—ã
        adminStartDisco();
        adminStartLuck(4);
        adminStartMutationSurge();

      }, 1000);

    }, 1000);

  }, 2000);
}

function stopAllVisuals() {
  // –£–±–∏—Ä–∞–µ–º —Ñ–æ–Ω—ã
  document.body.classList.remove("ramadan-bg");
  document.body.classList.remove("birthday-bg");
  document.body.classList.remove("disco");
  document.body.classList.remove("glitch");
  currentGlobalEvent = null;


  // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
  if (ramadanInterval) {
    clearInterval(ramadanInterval);
    ramadanInterval = null;
  }

  if (birthdayInterval) {
    clearInterval(birthdayInterval);
    birthdayInterval = null;
  }

  if (luckyRainInterval) {
    clearInterval(luckyRainInterval);
    luckyRainInterval = null;
  }

  // –£–¥–∞–ª—è–µ–º —Ç–µ–∫—Å—Ç—ã birthday
  document.querySelectorAll(".birthday-text").forEach(e => e.remove());

  // –£–¥–∞–ª—è–µ–º –≤—Å–ø—ã—à–∫–∏
  document.querySelectorAll(".flash-screen").forEach(e => e.remove());

  // –£–¥–∞–ª—è–µ–º —Å–µ—Ä—ã–π —ç–∫—Ä–∞–Ω snap
  document.querySelectorAll(".gray-screen-overlay").forEach(e => e.remove());
}
function createEndFlash() {
  const flash = document.createElement("div");
  flash.style.cssText = `
    position:fixed;
    inset:0;
    background:white;
    opacity:0.8;
    z-index:99999;
    pointer-events:none;
  `;
  document.body.appendChild(flash);
  setTimeout(() => flash.remove(), 200);
}
const canvas = document.createElement("canvas");
canvas.style.position = "fixed";
canvas.style.inset = "0";
canvas.style.pointerEvents = "none";
canvas.style.zIndex = "9998";
document.body.appendChild(canvas);

const ctx = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

function firework() {
  const x = Math.random() * canvas.width;
  const y = Math.random() * canvas.height * 0.5;
  const particles = [];

  for (let i = 0; i < 40; i++) {
    particles.push({
      x,
      y,
      dx: (Math.random() - 0.5) * 6,
      dy: (Math.random() - 0.5) * 6,
      life: 60
    });
  }

  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    particles.forEach(p => {
      p.x += p.dx;
      p.y += p.dy;
      p.life--;
      ctx.fillStyle = `hsl(${Math.random()*360},100%,50%)`;
      ctx.fillRect(p.x, p.y, 3, 3);
    });

    if (particles[0].life > 0) {
      requestAnimationFrame(animate);
    }
  }

  animate();
}
function updateLeaderboard() {
  if (!playerId) return;

  db.ref("leaderboard/" + playerId).set({
    money: money,
    rebirths: rebirths || 0
  });
}

let leaderboardMode = "money";

function setLeaderboardMode(mode) {
  leaderboardMode = mode;
  loadLeaderboard();
}
function loadLeaderboard() {
  firebase.database()
    .ref("leaderboard")
    .on("value", snapshot => {

      let data = snapshot.val();
      if (!data) return;

      let arr = Object.entries(data);

      arr.sort((a, b) => {
        if (leaderboardMode === "money") {
          return (b[1].money || 0) - (a[1].money || 0);
        } else {
          return (b[1].rebirths || 0) - (a[1].rebirths || 0);
        }
      });

      arr = arr.slice(0, 10);

      const list = document.getElementById("leaderboardList");
      list.innerHTML = "";

      arr.forEach((player, index) => {
        let id = player[0];
        let value = leaderboardMode === "money"
          ? player[1].money || 0
          : player[1].rebirths || 0;

        let icon = leaderboardMode === "money" ? "üí∞" : "üîÅ";

        let medal = "";
        if (index === 0) medal = "ü•á";
        if (index === 1) medal = "ü•à";
        if (index === 2) medal = "ü•â";

        let div = document.createElement("div");
        div.textContent = `${medal} ${index + 1}. ${id.slice(0,6)}... ‚Äî ${value} ${icon}`;

        if (id === playerId) {
          div.style.color = "gold";
        }

        list.appendChild(div);
      });
    });
}

const ramadanPack1 = [
  { name: "–§–∏–Ω–∏–∫", emoji:"üå¥", price:25000000, growTime:20000, rarity:"—ç–ø–∏—á–µ—Å–∫–æ–µ" },
  { name: "–õ—É–Ω–Ω—ã–π –∏–Ω–∂–∏—Ä", emoji:"üåôüçà", price:35000000, growTime:22000, rarity:"—ç–ø–∏—á–µ—Å–∫–æ–µ" }
];

const ramadanPack2 = [
  { name: "–ó–æ–ª–æ—Ç–æ–π —Ñ–∏–Ω–∏–∫", emoji:"‚ú®üå¥", price:100000000, growTime:25000, rarity:"–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ" },
  { name: "–°–≤—è—â–µ–Ω–Ω—ã–π —à–∞—Ñ—Ä–∞–Ω", emoji:"üïåüå∫", price:150000000, growTime:30000, rarity:"–º–∏—Ñ–∏—á–µ—Å–∫–æ–µ" }
];

function buyRamadanPack(type){

  let price = type === 1 ? 25000000 : 75000000;

  if(money < price){
    alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –®–∞–∫–∏–ª–µ–π!");
    return;
  }

  money -= price;
  updateUI();

  openRamadanRoulette(type);
}
function openRamadanRoulette(type){

  const pool = type === 1 ? ramadanPack1 : ramadanPack2;
  const roulette = document.getElementById("ramadanRoulette");
  const display = document.getElementById("rouletteItem");

  roulette.classList.remove("hidden");

  let spins = 0;

  const interval = setInterval(()=>{
    const random = pool[Math.floor(Math.random()*pool.length)];
    display.innerHTML = random.emoji;
    spins++;
    if(spins > 20){
      clearInterval(interval);
      finishRamadanRoll(pool);
    }
  },100);
}

function finishRamadanRoll(pool){

  const plant = pool[Math.floor(Math.random()*pool.length)];

  document.getElementById("rouletteItem").innerHTML = plant.emoji;

  setTimeout(()=>{
    document.getElementById("ramadanRoulette").classList.add("hidden");
    plantToFreePlot(plant);
  },1000);
}

function plantToFreePlot(plant){

  const freePlot = plots.find(p => !p.planted);

  if(!freePlot){
    alert("–ù–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö –≥—Ä—è–¥–æ–∫!");
    return;
  }

  freePlot.planted = {
    ...plant,
    plantedAt: Date.now()
  };

  updateUI();
  save();
}

loadLeaderboard();
animateMoney();
renderSeeds();
updateUI();
loadGrowth();
function loadAdminMessage() {


  fetch("adminMessage.json")
    .then(response => response.json())
    .then(data => {
      if (data.message && data.message.trim() !== "") {
        const msgBox = document.createElement("div");
        msgBox.style.position = "fixed";
        msgBox.style.top = "10px";
        msgBox.style.left = "50%";
        msgBox.style.transform = "translateX(-50%)";
        msgBox.style.background = "rgba(255, 215, 0, 0.9)";
        msgBox.style.color = "#000";
        msgBox.style.padding = "10px 20px";
        msgBox.style.borderRadius = "10px";
        msgBox.style.fontWeight = "bold";
        msgBox.style.zIndex = "9999";
        msgBox.style.boxShadow = "0px 2px 10px rgba(0,0,0,0.3)";
        msgBox.style.animation = "slideDown 0.5s ease-out";
        msgBox.innerText = data.message;
        document.body.appendChild(msgBox);

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
        setTimeout(() => {
          msgBox.remove();
        }, 5000);
      }
    })
    .catch(err => console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–¥–º–∏–Ω-—Å–æ–æ–±—â–µ–Ω–∏—è", err));
}

// –ê–Ω–∏–º–∞—Ü–∏—è
const style = document.createElement("style");
style.innerHTML = `
@keyframes slideDown {
  from { transform: translate(-50%, -50px); opacity: 0; }
  to { transform: translate(-50%, 0); opacity: 1; }
}`;
document.head.appendChild(style);

loadAdminMessage();
  </script>
</body>
</html>
